---
category:
  - Tech
tags:
  - Linux
  - MacOS
status: Done
---
# `lsof` 命令详解

`lsof`（List Open Files）是一个强大的命令行工具，用于列出系统中所有打开的文件。在 Linux 和 macOS 中，文件的概念包括普通文件、目录、网络套接字等，因此 `lsof` 也可以用于查看网络端口的占用情况。

---

## **1. 基本功能**

- 查看系统中打开的文件。
- 检查网络端口的占用情况。
- 分析进程和文件的关联。
- 调试和解决文件锁定问题。

---

## **2. 常见用法**

### **查看所有打开的文件**

```bash
lsof
```

列出当前系统中所有打开的文件。

### **查看某个文件的占用情况**

```bash
lsof <文件路径>
```

示例：

```bash
lsof /var/log/syslog
```

查看 `/var/log/syslog` 文件被哪些进程打开。

### **查看指定端口的占用情况**

```bash
lsof -i :<端口号>
```

示例：

```bash
sudo lsof -i :80
```

查看端口 80 的占用情况。

### **查看指定协议的网络连接**

```bash
lsof -i <协议>
```

示例：

```bash
lsof -i tcp
```

查看所有 TCP 连接。

### **查看与某个用户相关的文件**

```bash
lsof -u <用户名>
```

示例：

```bash
lsof -u root
```

列出 `root` 用户打开的所有文件。

### **查看某个进程打开的文件**

```bash
lsof -p <进程ID>
```

示例：

```bash
lsof -p 1234
```

查看 PID 为 1234 的进程打开的文件。

### **查看被锁定的文件**

```bash
lsof +L1
```

列出所有被删除但仍被进程使用的文件。

---

## **3. 参数详解**

| 参数        | 作用                 |
| --------- | ------------------ |
| `-i`      | 查看网络相关文件（如端口占用、协议） |
| `-u`      | 筛选某个用户打开的文件        |
| `-p`      | 查看特定进程打开的文件        |
| `+L1`     | 查看已删除但仍被占用的文件      |
| `<文件路径>`  | 查看特定文件的占用情况        |
| `-t`      | 仅显示进程 ID           |
| `-c <名称>` | 按命令名称筛选进程          |




