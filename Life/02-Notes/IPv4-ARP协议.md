---
category:
  - Tech
tags:
  - TCPIP
status: Done
---
>[!question] 为什么ARP不用IPv6那样的组播消息而是用广播
>技术上是可以的，但是因为一开始的技术路线就是更简单的广播形式，所以就这样了
>我理解的广播：
>1. 设备发送广播消息询问这个ip的mac是多少
>2. 所有本地的主机都会收到消息，如果ip是自己就回复
>
>我理解的组播：
>1. 因为设备发送组播消息询问这个ip的mac是多少
>2. 订阅了组播消息的人收到消息，如果ip是自己就回复

ARP（Address Resolution Protocol，地址解析协议）是一种网络协议，主要用于在局域网（LAN）中将 IP 地址解析为对应的 MAC 地址（物理地址）。在一个网络中，设备之间通过 MAC 地址（硬件地址）进行数据通信，而 IP 地址是用于逻辑寻址的。因此，当设备通过 IP 地址发送数据时，必须先通过 ARP 知道目标设备的 MAC 地址。

### ARP 寻址的工作过程

ARP 寻址的核心功能是将目标设备的 IP 地址解析成 MAC 地址，具体过程如下：

1. **ARP 请求（ARP Request）**：
   - 发送方设备（如计算机）想要与局域网中的另一台设备通信，首先会发送一个广播 ARP 请求，询问某个 IP 地址对应的 MAC 地址。
   - 这个请求报文包含了发送方的 IP 地址和 MAC 地址，以及目标设备的 IP 地址。因为是广播，所以报文会发给同一网络内的所有设备。

2. **ARP 响应（ARP Reply）**：
   - 局域网中的所有设备接收到 ARP 请求后，只有持有该 IP 地址的设备会做出回应。
   - 目标设备通过单播发送 ARP 响应报文，告知发送方它的 MAC 地址。这个响应报文只会发送给请求设备，而不是广播给整个网络。

3. **缓存**：
   - 发送方设备收到 ARP 响应后，会将目标 IP 地址和 MAC 地址的对应关系缓存到本地的 ARP 表中。
   - 这样，下次该设备需要与同一目标设备通信时，就不再需要发送 ARP 请求，而是直接查找本地缓存。

4. **ARP 表（ARP Cache）**：
   - 每台设备都维护一张 ARP 表，其中存储着 IP 地址与 MAC 地址的映射。ARP 表的条目会有一定的有效期，当过期时，设备需要重新发送 ARP 请求来更新信息。

> ARP是通过广播来通信的，IPv4广播地址详情请看笔记IPv4地址
### ARP 的用途
ARP 主要用于局域网内的通信，当一个设备需要将 IP 层的数据包通过数据链路层（以太网）发送给局域网内的另一台设备时，必须先通过 ARP 解析得到目标设备的 MAC 地址。通常，ARP 在以下情况下被使用：

- 局域网内的设备之间通信。
- 路由器通过 ARP 获取局域网内设备的 MAC 地址，以便将数据包正确转发到目标设备。

### ARP 的两种变体
- **RARP（Reverse ARP，反向地址解析协议）**：用于通过 MAC 地址获取 IP 地址，主要用于无盘工作站或某些网络设备的自动配置。
- **Proxy ARP（代理 ARP）**：路由器等设备可以代表其他设备响应 ARP 请求，用于跨子网通信或实现某些特殊的网络拓扑结构。

### ARP 的安全问题
ARP 是一种简单的协议，但它容易受到攻击，例如 ARP 欺骗（ARP Spoofing）。攻击者可以通过伪造 ARP 响应，将其自己的 MAC 地址冒充为合法设备的 MAC 地址，导致数据包被错误地发送到攻击者的设备上。为了防止这种攻击，网络管理员通常会部署一些安全措施，如动态 ARP 检测（DAI）或静态 ARP 表。

### 小结
ARP 是一个关键的网络协议，用于将 IP 地址解析为 MAC 地址，从而确保局域网中设备之间的正常通信。尽管其原理简单，但 ARP 在计算机网络，特别是以太网通信中，扮演着重要角色。