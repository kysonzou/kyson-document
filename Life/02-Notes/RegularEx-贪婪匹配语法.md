---
category:
- Tech
tags:
- RegularE
status: Done
---
贪婪匹配是默认模式，它会尽可能多地匹配字符。常见的贪婪量词包括：`*、+、?、{n,m}` 等。

**示例**：匹配 HTML 标签内容。
```regex
<b>.*</b>
```
解释：

- \<b>：匹配开头的 \<b> 标签。

- `.*`：贪婪匹配任意字符，直到遇到最后的 \</b> 标签。

**Python示例**
```python
import re

text = "<b>hello</b> and <b>world</b>"
result = re.search(r"<b>.*</b>", text)
print(result.group())  # 输出：<b>hello</b> and <b>world</b>

# .* 匹配了 hello 和 world 之间的所有字符，导致匹配结果包含所有内容。
```

**贪婪匹配的工作步骤**

1. **逐字符匹配**：从输入字符串的起始位置开始，正则引擎依次尝试匹配正则表达式中的每一个元素。

2. **尽可能多地匹配**：遇到贪婪量词（如 *, +, {m,n}）时，贪婪匹配会先匹配到字符串的最大可能长度。例如，a+ 会尝试匹配尽可能多的 a 字符。

3. **尝试满足后续部分**：在完成贪婪匹配后，正则引擎会继续尝试匹配模式的剩余部分。如果匹配成功，则结束；否则进入回溯阶段。

4. **回溯（Backtracking）**：如果后续匹配失败，贪婪匹配会逐步减少已匹配的字符数量，试图寻找符合整个模式的新匹配路径。通过回溯，贪婪匹配尝试逐步减少先前的匹配数量，以找到满足整个表达式的其他可能组合。

**示例：贪婪匹配的过程**

假设我们有一个字符串 "aaab"，用正则表达式 a+b 来进行匹配。a+ 是一个贪婪量词，它会尽可能多地匹配 a 字符，然后再匹配 b。以下是匹配过程的详细步骤：

1. **开始匹配**：从字符串的第一个字符 "a" 开始，a+ 尽可能多地匹配，匹配到 "aaa"。

2. **匹配后续**：匹配完 a+ 后，继续匹配 b。

3. **匹配成功**：整个模式匹配成功，返回匹配结果。

  
再举一个失败的例子。假设我们用正则表达式 a+b 来匹配 "aaaac"：

1. **开始匹配**：a+ 会尽可能多地匹配所有 "a"，即匹配到 "aaaa"。

2. **匹配后续**：尝试匹配 b，发现接下来的字符是 c，匹配失败。

3. **回溯调整**：贪婪匹配会回溯一步，把匹配数量减少为 "aaa"，再尝试匹配 b，仍然失败。

4. **进一步回溯**：继续减少 a+ 的匹配数量至 "aa"，尝试匹配 b，再次失败。

5. **彻底匹配失败**：当所有回溯路径都尝试过后仍不成功，最终匹配失败。

**贪婪匹配的特点**

- **尽可能多地匹配**：在遇到贪婪量词时，正则引擎会首先匹配尽可能多的字符。

- **回溯调整匹配数量**：如果匹配后续部分失败，贪婪匹配会回溯调整已匹配的字符数量，尝试新的匹配路径。
- **效率影响**：由于回溯机制的存在，在匹配复杂模式或长文本时，贪婪匹配可能导致较高的性能开销，尤其是正则模式中有多层嵌套或交叉条件的情况下。