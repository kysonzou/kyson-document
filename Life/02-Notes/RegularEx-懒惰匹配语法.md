---
category:
  - Tech
tags:
  - RegularE
status: Done
---
懒惰匹配会尽可能少地匹配字符，可以通过在量词后添加 ? 实现懒惰匹配：`*?、+?、??、{n,m}?`。

-  *?：匹配零次或更多次，但尽可能少匹配

-  +?：匹配一次或更多次，但尽可能少匹配

-  ??：匹配零次或一次，但尽可能少匹配

-  {m,n}?：匹配 m 到 n 次，但尽可能少匹配

**示例**：懒惰匹配 HTML 标签内容。
```regex
<b>.*?</b>
```
解释：

- \<b>：匹配开头的 \<b> 标签。

- `.*?`：懒惰匹配任意字符，匹配到第一个 \</b> 标签即停止。

**Python示例**
```python
import re

text = "<b>hello</b> and <b>world</b>"
result = re.findall(r"<b>.*?</b>", text)
print(result)  # 输出：['<b>hello</b>', '<b>world</b>']
# 通过懒惰匹配，.*? 在遇到第一个 </b> 时停止匹配，因此能够分别匹配 <b>hello</b> 和 <b>world</b>。
```

**懒惰匹配的工作原理**

懒惰匹配的工作过程如下：

1. **最少匹配**：

    - 正则引擎在遇到懒惰量词（如 *?、+?、?? 等）时，会尽可能少地匹配字符，尝试匹配最小可能的字符数。
    
2. **满足后续模式**：

    - 在尽可能少地匹配的情况下，正则引擎会尝试匹配表达式的后续部分。如果后续部分无法匹配成功，懒惰匹配会逐渐增加匹配的字符数量，直到匹配成功或匹配失败。

3. **扩展匹配**：

    - 如果最少匹配的数量无法满足整个正则模式，正则引擎会增加匹配数量（逐步扩展匹配），直到找到匹配路径。

4. **不再扩展**：

    - 一旦找到符合整个模式的最小匹配量，懒惰匹配就会停止扩展，即使可以匹配更多字符也不会继续。
  
**示例：懒惰匹配的过程**

假设我们有一个字符串 "aaaa"，想用正则表达式 a+? 来匹配它。

1. **开始匹配**：引擎从字符串的开头开始。

2. **最小化匹配**：a+? 尽可能少地匹配，所以它先匹配到第一个 “a”。

3. **检查剩余模式**：如果整个模式匹配成功，引擎会停止。如果不满足模式，引擎会回到第一个 “a”，并尝试扩展匹配的数量。

4. **扩展匹配**：懒惰匹配会在必要时逐步增加匹配字符的数量，直到满足整个表达式。
